import { DynamicMetaTags } from 'components/MetaTags';
import { CodeReferenceLink } from 'components/CodeReference';

<DynamicMetaTags
  title="Basics of Pipelines | Dagster"
  description="Dagster pipeline is a set of solids which have data dependencies on each other to create a directed acyclic graph.
  Here's a guide to construct a complex pipeline."
/>

import AnchorHeading from 'components/AnchorHeading';
import PyObject from 'components/PyObject';

# Basics of Pipelines

<CodeReferenceLink filePath="examples/docs_snippets/docs_snippets/intro_tutorial/basics/e03_pipelines/" />

Our pipelines wouldn't be very interesting if they were limited to solids acting in isolation from
each other. Pipelines are useful because they let us connect solids into arbitrary
[DAGs](https://en.wikipedia.org/wiki/Directed_acyclic_graph) of computation.

## Let's Get Serial

We'll add a second solid to the pipeline we worked with in the first section of the tutorial.

This new solid will consume the output of the first solid, which read the cereal dataset in from
disk, and in turn will sort the list of cereals by their calorie content per serving.

```python literalinclude emphasize-lines=16,20,38 caption=serial_pipeline.py
file:/docs_snippets/docs_snippets/intro_tutorial/basics/e03_pipelines/serial_pipeline.py
startAfter:start_serial_pipeline_marker_0
endBefore:end_serial_pipeline_marker_0
```

You'll see that we've modified our existing `load_cereals` solid to return an output, in this case
the list of dicts into which `csv.DictReader <python:csv.DictReader>` reads the cereals dataset.

We've defined our new solid, `sort_by_calories`, to take a user-defined input, `cereals`, in
addition to the system-provided <PyObject module="dagster" object="SystemComputeExecutionContext"
displayText="context" /> object.

We can use inputs and outputs to connect solids to each other. Here we tell Dagster that although
`load_cereals` doesn't depend on the output of any other solid, `sort_by_calories` does&mdash;it
depends on the output of `load_cereals`.

Let's visualize this pipeline in Dagit:

```bash
dagit -f serial_pipeline.py
```

Navigate to
[http://127.0.0.1:3000/pipeline/serial_pipeline/](http://127.0.0.1:3000/pipeline/serial_pipeline/)
or choose "serial_pipeline" from the left sidebar:

![serial_pipeline_figure_one.png](/assets/images/tutorial/serial_pipeline_figure_one.png)

<br />

## A More Complex DAG

Solids don't need to be wired together serially. The output of one solid can be consumed by any
number of other solids, and the outputs of several different solids can be consumed by a single
solid.

```python literalinclude showLines emphasize-lines=55-59 startLine=7 caption=complex_pipeline.py
file:/docs_snippets/docs_snippets/intro_tutorial/basics/e03_pipelines/complex_pipeline.py
startAfter:start_complex_pipeline_marker_0
endBefore:end_complex_pipeline_marker_0
```

First we introduce the intermediate variable `cereals` into our pipeline definition to represent the
output of the `load_cereals` solid. Then we make both `sort_by_calories` and `sort_by_protein`
consume this output. Their outputs are in turn both consumed by `display_results`.

Let's visualize this pipeline in Dagit:

```bash
dagit -f complex_pipeline.py
```

![complex_pipeline_figure_one.png](/assets/images/tutorial/complex_pipeline_figure_one.png)

When you execute this example from Dagit, you'll see that `load_cereals` executes first, followed by
`sort_by_calories` and `sort_by_protein`&mdash;in any order&mdash;and that `display_results`
executes last, only after `sort_by_calories` and `sort_by_protein` have both executed.

In more sophisticated execution environments, `sort_by_calories` and `sort_by_protein` could execute
not just in any order, but at the same time, since they don't depend on each other's
outputs&mdash;but both would still have to execute after `load_cereals` (because they depend on its
output) and before `display_results` (because `display_results` depends on both of their outputs).

We'll write a simple test for this pipeline showing how we can assert that all four of its solids
executed successfully.

```python literalinclude showLines startLine=73 caption=complex_pipeline.py
file:/docs_snippets/docs_snippets/intro_tutorial/basics/e03_pipelines/complex_pipeline.py
lines:73-80
```

<br />

<br />
