table:
  name: lineage.pub.middle
  dialect: trino
  materialization: view
  purpose: model
  dependencies:
  - lineage.pub.source
  depended-on-by:
  - lineage.pub.knis
  - lineage.pub.sink
  - lineage.pub.test_middle
  columns:
  - name: user_id
    datatype: integer
    classifiers:
    - DATA.uid
    lineage:
      copy:
      - lineage.pub.source.user_id
    forward-lineage:
      copy:
      - lineage.pub.sink.uid
  - name: phone
    datatype: varchar
    classifiers:
    - DATA.pii
    lineage:
      copy:
      - lineage.pub.source.phone
    forward-lineage:
      copy:
      - lineage.pub.sink.phone
      modify:
      - lineage.pub.test_middle.reason
  - name: txn_date
    datatype: varchar
    lineage:
      copy:
      - lineage.pub.source.txn_date
    forward-lineage:
      copy:
      - lineage.pub.knis.txn_date
      - lineage.pub.sink.txn_date
  - name: qty
    datatype: bigint
    lineage:
      modify:
      - lineage.pub.source.qty
    forward-lineage:
      copy:
      - lineage.pub.sink.qty
      modify:
      - lineage.pub.knis.qty
  tests:
  - expect: unique_columns(["user_id", "user_id"])
  lineage:
    scan:
    - lineage.pub.source.txn_date
    - lineage.pub.source.user_id
  source-locations:
  - path: failing_metadata/middle.sdf.yml
  - path: models/middle.sql
